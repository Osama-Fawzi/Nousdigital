name: CI
# This workflow is triggered on pushes to the repository.
on:
  push:
    branches:
    - develop
    - feature/*
jobs:
  build:
    runs-on: macos-latest
    steps:
    - uses: actions/checkout@master
    - name: Install Dependences
      run: |
        cd Nousdigital
        pod repo update
        pod install
      shell: bash
    - name: Start xcodebuild test
      run: xcodebuild clean test -workspace "Nousdigital.xcworkspace" -scheme "Nousdigital" -destination "platform=iOS Simulator,name=iPhone 8,OS=latest"
# jobs:
#   test:
#     runs-on: macos-latest
#     steps:
#     - uses: actions/checkout@master
#     - name: Switch XCode Version
#       run: sudo xcode-select -s /Applications/Xcode_11.app
#     - name: Install Dependences
#       run: |
#         cd Nousdigital
#         pod repo update
#         pod install
#       shell: bash
#     - uses: ty0x2333/cocoapods-action@master
#       with:
#         additional_build_params: -destination 'platform=iOS Simulator,name=iPhone 11,OS=13.0'
#         additional_lint_params: --private
#       run: xcodebuild clean test -project Nousdigital.xcodeproj -scheme Nousdigital -destination "platform:iOS Simulator,OS:12.4, name:iPhone 8 Plus" 
# jobs:
#   test:
#     name: Test
#     runs-on: macos-latest
#     strategy:
#         matrix:
#           destination: ['platform=iOS Simulator,OS=12.2,name=iPhone X']
#     steps:
#       - name: Checkout
#         uses: actions/checkout@master
#       - name: Build and test
#         run: |
#           cd Nousdigital
#           xcodebuild clean test -project Nousdigital.xcworkspace -scheme Nousdigital -destination "${destination}" CODE_SIGN_IDENTITY="" CODE_SIGNING_REQUIRED=NO ONLY_ACTIVE_ARCH=NO
#           bash <(curl -s https://codecov.io/bash)
#         env: 
#          destination: ${{ matrix.destination }}
# jobs:
#   test:
#     # Job name is Test
#     name: Test
#     # This job runs on macOS
#     runs-on: macos-latest
#     strategy:
#       matrix:
#         destination: ['platform=iOS Simulator,OS=12.4,name=iPhone 8']
# #         xcode: ['/Applications/Xcode_10.3.app/Contents/Developer']
#     steps:
#       - name: Checkout
#         uses: actions/checkout@v1
#       - name: Bundle Install
#         run: bundle install
#         env:
#           BUNDLE_GITHUB__COM: x-access-token:${{ secrets.GITHUB_PERSONAL_ACCESS_TOKEN }}
#       - name: Dependencies
#         run: 
#           bundle exec pod install
#         env:
#           DEVELOPER_DIR: ${{ matrix.xcode }}
# jobs:
#   test:
#     # Job name is Test
#     name: Test
#     # This job runs on macOS
#     runs-on: macOS-latest
#     strategy:
#       matrix:
#         destination: ['platform=iOS Simulator,OS=12.4,name=iPhone 8']
#         xcode: ['/Applications/Xcode_10.3.app/Contents/Developer']
#     steps:
#       - name: Checkout
#         uses: actions/checkout@v1
#       - name: Bundle Install
#         run: bundle install
#       - name: Dependencies
#         run: 
#           bundle exec pod install
#         env:
#           DEVELOPER_DIR: ${{ matrix.xcode }}
#       - name: Build and test
#         run: bundle exec fastlane scan --destination "${destination}" --scheme "YOUR_APP_SCHEME"
#         env:
#           destination: ${{ matrix.destination }}
#           DEVELOPER_DIR: ${{ matrix.xcode }}
#       - name: Archive Failed Tests artifacts
#         if: failure()
#         uses: actions/upload-artifact@v1
#         with:
#           name: FailureDiff
#           path: YouAppTests/FailureDiffs
#       - name: Releasing
#         run: bundle exec fastlane release
#         env:
#           DEVELOPER_DIR: ${{ matrix.xcode }}
#           YOUR_ENVIRONMENT_VARIABLES_HERE: ${{ secret.XXX }}
